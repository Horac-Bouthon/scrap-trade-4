{% extends "project_main/base.html" %}
{% load static %}
{% load i18n %}

{% block style %}
<style>
  body {
    background-image: url("{{ object.owner.customer_background.url }}");
    background-repeat: no-repeat;
    background-size: cover;
}
</style>
{% endblock style %}

{% block content %}

    <article class="media content-section">
      <a href="{% url 'project-customer-info' object.owner.pk %}" target="_blank">
        <img class="rounded-circle customer-logo" src="{{ object.owner.customer_logo.url }}">
      </a>
      <div class="media-body">
        {% trans "Back to auction" as var_back %}
        <div class="auction_nav">
          <a class="btn btn-outline-secondary" href="{% url 'ah-customer-auction' object.owner.pk %}">{{ var_back }}</a>
          <p></p>
        </div>
        {% trans "Click to update answer" as var_hint1 %}
        <h2 class="customer-name">
          {% if "customers.is_poweruser" in perms or object.is_new or object.is_successful or object.is_accepted %}
            {% if "customers.is_poweruser" in perms %}
              <a class="" href="{% url 'ah-answer-update' object.pk %}" data-toggle="tooltip" data-placement="top" title="{{ var_hint1 }}">{{ object.description }}</a>
            {% else %}
              <a class="" href="{% url 'ah-answer-customer-update' object.pk %}" data-toggle="tooltip" data-placement="top" title="{{ var_hint1 }}">{{ object.description }}</a>
            {% endif %}
          {% else %}
            {{ object.description }}
          {% endif %}
        </h2>
        <p>
          {% trans "Status:" as var_status %}
          <span class="customer-detail-content-highlighite">{{ var_status }} </span>
          {% if object.is_new %}
            {% trans "New" as var_new %}
            <span class="customer-detail-content">{{ var_new }}</span>
          {% endif %}
          {% if object.is_confirmed %}
            {% trans "Confirmed" as var_corf %}
            <span class="customer-detail-content">{{ var_corf }}</span>
          {% endif %}
          {% if object.is_successful %}
            {% trans "Successful" as var_in_proc %}
            <span class="customer-detail-content">{{ var_in_proc }}</span>
          {% endif %}
          {% if object.is_accepted %}
            {% trans "Accepted" as var_accepted %}
            <span class="customer-detail-content">{{ var_accepted }}</span>
          {% endif %}
          {% if object.is_closed %}
            {% trans "Closed" as var_clos %}
            <span class="customer-detail-content">{{ var_clos }}</span>
          {% endif %}
          {% if object.is_cancelled %}
            {% trans "Canceled" as var_canc %}
            <span class="customer-detail-content">{{ var_canc }}</span>
          {% endif %}
        </p>
        <p>
          {% trans "Auction date:" as var_auction %}
          <span class="customer-detail-content-highlighite">{{ var_auction }} </span>
          <span class="customer-detail-content">{{ object.ah_offer.auction_date }}</span>
        </p>
        <p>
          {% trans "Delivery date:" as var_delivery %}
          <span class="customer-detail-content-highlighite">{{ var_delivery }} </span>
          <span class="customer-detail-content">{{ object.ah_offer.delivery_date }}</span>
        </p>
        <p>
          {% trans "Answer total:" as var_at %}
          <span class="customer-detail-content-highlighite">{{ var_at }} </span>
          <span class="customer-detail-content">{{ object.total_price }}</span>
        </p>
        <p/>
        {% if object.my_lines.all.count > 0 %}
          <table class="table_lines">
            <tr class="table_lines">
              {% trans "ID" as var_o_n %}
              <th class="th_lines table_lines">{{ var_o_n }}</th>
              {% trans "Description" as var_offer_des %}
              <th class="th_lines table_lines">{{ var_offer_des }}</th>
              {% trans "Material class" as var_mc %}
              <th class="th_lines table_lines">{{ var_mc }}</th>
              {% trans "Amount" as var_crea %}
              <th class="th_lines table_lines">{{ var_crea }}</th>
              {% trans "Price per unit" as var_ppu %}
              <th class="th_lines table_lines">{{ var_ppu }}</th>
              {% trans "Price total" as var_line_total %}
              <th class="th_lines table_lines">{{ var_line_total }}</th>
            </tr>
            {% trans "Click to update line" as var_hint3 %}
            {% for line in  object.my_lines.all %}
            <tr class="table_lines">
              <td class="td_lines table_lines"> {{ line.id }} </td>
              <td class="td_lines table_lines">
                {{ line.offer_line.description }}
              </td>
              <td class="td_lines table_lines">
                <a class="table_lines" href="{% url 'ah-mat-class-detail' line.offer_line.mat_class.id %}" data-toggle="tooltip" data-placement="top" title="{{ line.mat_class.act_mat_class_description }}" target="_blank">
                  {{ line.offer_line.mat_class.act_display_name }}
                </a>
              </td>
              <td class="td_lines table_lines"> {{ line.offer_line.amount }} {{ line.offer_line.mat_class.measurement_unit }} </td>
              <td class="td_lines table_lines">
                {% if power_can_change or object.is_new %}
                  {% trans "Click to update price per unit" as var_hint3 %}
                  <a class="table_lines" href="{% url 'ah-customer-answers-line-ppu' object.pk line.pk %}" data-toggle="tooltip" data-placement="top" title="{{ var_hint3 }}">
                    {{ line.ppu }}
                  </a>
                {% else %}
                  {{ line.ppu }}
                {% endif %}
               </td>
              <td class="td_lines table_lines">
                {% if power_can_change or object.is_new %}
                  <a class="table_lines" href="{% url 'ah-customer-answers-line-total' object.pk line.pk %}" data-toggle="tooltip" data-placement="top" title="{{ var_hint3 }}">
                    {{ line.total_price }}
                  </a>
                {% else %}
                  {{ line.total_price }}
                {% endif %}

              </td>
            </tr>
            {% endfor %}
          </table>
        {% endif %}
      </div>
    </article>


{% endblock content %}

{% block spec_action %}
{% endblock spec_action %}
