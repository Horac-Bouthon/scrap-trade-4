{% extends "project_main/base.html" %}
{% load static %}
{% load crispy_forms_tags %}
{% load i18n %}

{% block style %}
{% if customer.customer_background %}
  <style>
    body {
      background-image: url("{{ customer.customer_background.url }}");
      background-repeat: no-repeat;
      background-size: cover;
  }
  </style>
{% endif %}
{% endblock style %}


{% block content %}
  <article class="media content-section">
    <a href="{% url 'project-customer-info' customer.pk %}" target="_blank">
      <img class="rounded-circle customer-logo" src="{{ customer.customer_logo.url }}">
    </a>
    <div class="media-body">
      <h2 class="customer-name">{{ object.customer_name }}</h2>
      {% trans "Offer" as var_offer %}
      <h5>{{ var_offer }}</h5>
        <h3 class="customer-name">{{ offer.description }}</h3>
        <p>
          {% trans "Status:" as var_status %}
          <span class="customer-detail-content-highlighit">{{ var_status }} </span>
          <span class="customer-detail-content">{{ offer.actual_state.act_state_name }}</span>
        </p>
        <p>
          {% trans "Auction date:" as var_auction %}
          <span class="customer-detail-content-highlighite">{{ var_auction }} </span>
          <span class="customer-detail-content">{{ offer.auction_date }}</span>
        </p>
        <p>
          {% trans "Delivery date:" as var_delivery %}
          <span class="customer-detail-content-highlighite">{{ var_delivery }} </span>
          <span class="customer-detail-content">{{ offer.delivery_date }}</span>
        </p>
        <p>
          {% trans "Minimal price:" as var_min_price %}
          <span class="customer-detail-content-highlighite">{{ var_min_price }} </span>
          <span class="customer-detail-content">{{ offer.minimal_total_price }}</span>
        </p>
        <p/>
        {% if offer.lines.all.count > 0 %}
          <table class="table_lines">
            <tr class="table_lines">
              {% trans "ID" as var_o_n %}
              <th class="th_lines table_lines">{{ var_o_n }}</th>
              {% trans "Description" as var_des %}
              <th class="th_lines table_lines">{{ var_des }}</th>
              {% trans "Material class" as var_mc %}
              <th class="th_lines table_lines">{{ var_mc }}</th>
              {% trans "Amount" as var_crea %}
              <th class="th_lines table_lines">{{ var_crea }}</th>
              {% trans "Minimal unit price" as var_crea %}
              <th class="th_lines table_lines">{{ var_crea }}</th>
            </tr>
            {% trans "Click to update line" as var_hint3 %}
            {% for line in  offer.lines.all %}
            <tr class="table_lines">
              <td class="td_lines table_lines"> {{ line.id }} </td>
              <td class="td_lines table_lines">{{ line.description }}</td>
              <td class="td_lines table_lines">
                <a class="table_lines" href="{% url 'ah-mat-class-detail' line.mat_class.id %}" data-toggle="tooltip" data-placement="top" title="{{ line.mat_class.act_mat_class_description }}" target="_blank">
                 {{ line.mat_class.act_display_name }}
                </a>
              </td>
              <td class="td_lines table_lines"> {{ line.amount }} {{ line.mat_class.measurement_unit }} </td>
              <td class="td_lines table_lines"> {{ line.minimal_ppu }} </td>
            </tr>
            {% endfor %}
          </table>
        {% endif %}
      <p/>
      {% trans "New answer" as var_new_answer %}
      <h5>{{ var_new_answer }}</h5>
      <form class="" method="POST" enctype="multipart/form-data">
        {% csrf_token %}
        <fieldset class="form-group">
          {{ form|crispy }}
        </fieldset>
        <div class="form-group">
          {% trans "Create" as var_add %}
          <button class="btn btn-outline-info" type="submit">{{ var_add }}</button>
          {% trans "Cancel" as var_cancel %}
          <a class="btn btn-outline-secondary" href="{% url 'ah-customer-auction' customer.pk %}">{{ var_cancel }}</a>
        </div>
      </form>
    </div>
  </article>
{% endblock content %}

{% block spec_action %}
{% endblock spec_action %}
