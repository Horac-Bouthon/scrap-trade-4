
{% extends 'project_main/base.html' %}

{% load i18n %}
{% load crispy_forms_tags %}


{% block content %}

  {% if arrival == 'too_soon' %}

    <section class="container">
      <dl class="h5 py-5
                 mx-md-4 mx-lg-5">

        <h4 class="mb-4 font-weight-bold">
          {% trans "This auction has not started yet." %}
        </h4>

        <dt>{% trans "Auction is starting at: " %}</dt>
        <dd>{{ offer.auction_start|date:"d.m.Y" }} {{ offer.auction_start|time:"H:i" }}</dd>
      </dl>
    </section>





  {% elif arrival == 'too_late' %}

    <section class="container">
      <dl class="h5 py-5
                 mx-md-4 mx-lg-5">

        <h4 class="mb-4 font-weight-bold">
          {% trans "This auction has already ended." %}
        </h4>
      </dl>
    </section>

    {# @todo; Get some info about the auction? Description at least? #}




  {% elif arrival == 'ok' %}

    {% include 'project_main/__content-header.html' %}

    <section class="container">

      <dl>
        <h4>{% trans "Auction details" %}</h4>

        <div class="d-flex">
          <dl>
            <dt>{% trans 'Minimal total price:' %}</dt>
            <dd>{{ offer.minimal_total_price }}</dd>
          </dl>
          <dl>
            <dt>{% trans 'Delivery date:' %}</dt>
            <dd>{{ offer.delivery_date|date:"d.m.Y" }}</dd>
          </dl>
          <dl>
            <dt>{% trans 'Auction end:' %}</dt>
            <dd>{{ offer.auction_end|date:"d.m.Y" }} {{ offer.auction_end|time:"H:i" }}</dd>
          </dl>
        </div>

      </dl>

      <div class="d-flex">

        <section class="flex-fill">
          <h4 class="section-header">
            {% trans "Offer detail" %}
          </h4>

          <table class="table_lines">
            <tr class="table_lines">
              {% trans "Description" as var_offer_des %}
              <th class="th_lines table_lines">
              {{ var_offer_des }}
              </th>
              {% trans "Amount" as var_amounth %}
              <th class="th_lines table_lines">{{ var_amounth }}
              </th>
              {% trans "Minimal price per unit" as var_ppu %}
              <th class="th_lines table_lines">{{ var_ppu }}
              </th>
            </tr>
            {% for line in  offer.lines.all %}
              <tr class="table_lines">
                <td class="td_lines table_lines">{{ line.description }}</td>
                <td class="td_lines table_lines"> {{ line.amount }} {{ line.mat_class.measurement_unit }} </td>
                <td class="td_lines table_lines">
                  {{ line.minimal_ppu }}
                </td>
              </tr>
            {% endfor %}
          </table>
        </section>

        <section class="ml-3">
          <h4 class="section-header m-0">
            {% trans "Best bids" %}
          </h4>

          <ul class="bid__list">

            {% for item in list_bb%}
            <li class="{{ item.str_class }}">
              <div class="bid__amount">
                {{ item.total_price }}
              </div>
            </li>
            {% endfor %}
          </ul>
        </section>


      </div>

    </section>

    <style>
     .bid__list {
         padding-left: 0;
         list-style: none;
     }
     .bid__item {
         padding: 0.25rem 1.5rem;
         margin: 0.5rem 0;

         background: white;
         border: 1px solid #dee2e6;
         border-radius: 0.25rem;
         box-shadow: 0 .125rem .25rem rgba(0,0,0,.075);

         display: flex;
         align-items: center;
     }
     .bid__time {
         color: #6c757d;
         text-align: right;
         width: 3rem;
         margin-top: 10px;  /* slight off-center */
     }
     .bid__amount {
         text-align: right;
         font-weight: bold;
         font-size: 2.5rem;
         line-height: 1.15em;

         padding-right: 0.25rem;

         flex: 1 1 auto; /* flex-fill */
     }
     .bid__item--best {
         background: #ff5;
     }
     .bid__item--owned {
         color: var(--orange);
     }
    </style>

  {% endif %}

{% endblock content %}
